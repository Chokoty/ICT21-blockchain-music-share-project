<head>
    <!-- Bootstrap include -->
    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"> -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    
    <!-- fontawsome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/v4-shims.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
    
    <!-- jquery 버전 유의 -->
    <!-- slim/jquery, 3.1.0 윗 버전에서 ajax가 작동하지 않는 오류 확인 -->
    <!-- Bootstrap의 CDN을 copy&paste 하되 Line 8의 버전만 3.1.0으로 수정하세요 -->
    <script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>

    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0">
</head>

<body>  
    <nav class="navbar mv-100 navbar-expand-md navbar-dark bg-dark ">
        <div class="container-fluid">
            <a class="navbar-brand" href="/" style="font-family: 'Fredoka One'">MuseShare*</a>
            <button class="navbar-toggler m-0 btn-sm" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse " id="navbarsExampleDefault">
                <ul class="navbar-nav  justify-content-around">
                    <li class="nav-item ">
                        <a class="nav-link" href="/">소개 <span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/dashboard">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">후원/대여</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="p-5 rounded-3" style="background-color:#FEF3BB
    ;">
        <div class="container-fluid py-5">
          <h1 class="display-5 fw-bold fs-2">음원수익 공유플랫폼</h1>
          <p class="col-md-8 fs-6">원작자와 참여자들의 수익 공유를 통해 <br>좋아하는 아티스트를 후원하면서 2차창작을 보다 자유롭게...</p>
          <button class="btn btn-dark btn" type="button">자세히</button>
        </div>
    </div>
    <div class="p-5 rounded-3" style="background-color:#FEF3BB
    ;">
        <div class="container-fluid py-5">
          <h1 class="display-5 fw-bold fs-2">음원수익 공유플랫폼</h1>
          <p class="col-md-8 fs-6">원작자와 참여자들의 수익 공유를 통해 <br>좋아하는 아티스트를 후원하면서 2차창작을 보다 자유롭게...</p>
          <button class="btn btn-dark btn" type="button">자세히</button>
        </div>
    </div>
    <div class="p-5 bg-light rounded-3">
        <div class="container w-80">
        <div class="row justify-content-md-center">
            <h4 class="mb-4 text-center">등록된 음원 목록</h4>

            <div class="d-grid gap-2 d-flex justify-content-center">
                <div class="">
                    <div class="card">
                      <div class="card-header">#0001</div>
                      <div class="card-body">
                        <img class="row text-center" width="60px"
                        src="https://cdn-icons.flaticon.com/png/512/3674/premium/3674842.png?token=exp=1638222078~hmac=a96acddb46ce58c530cf8ce5516f165e"
                        <h3 class="row card-title text-primary">Savage</h3>
                      </div>
                    </div>
                  </div>
                  <div class="">
                    <div class="card">
                      <div class="card-header">#0002</div>
                      <div class="card-body">
                        <img class="row text-center" width="60px"
                        src="https://cdn-icons.flaticon.com/png/512/3674/premium/3674842.png?token=exp=1638222078~hmac=a96acddb46ce58c530cf8ce5516f165e"
                        <h3 class="row card-title text-primary">작은것들을위한시</h3>
                        
                      </div>
                    </div>
                  </div>
                 <div class="">
                    <div class="card">
                      <div class="card-header">#0004</div>
                      <div class="card-body">
                        <img class="row text-center" width="60px"
                        src="https://cdn-icons.flaticon.com/png/512/3674/premium/3674842.png?token=exp=1638222078~hmac=a96acddb46ce58c530cf8ce5516f165e"
                        <h3 class="row card-title text-primary">Tempo</h3>
                        
                      </div>
                    </div>
                  </div>
                </div>
                <div class="">
            </div>
        </div>
    </div>
    </div>
    <div class="p-5 bg-light rounded-3">
        <div class="container w-50">
        <div class="row justify-content-md-center">
          
            <div class="row-lg ">
                <div id="add-alert" class="alert alert-primary" role="alert">
                    This is a primary alert with <a href="#" class="alert-link">an example link</a>. Give it a click if you like.
                  </div>
                <h4 class="mb-4">좋아하는 아티스트의 음원에 동참하세요!</h4>
            </div>

            <div class="d-grid gap-2 d-flex justify-content-center">
                <button class="btn btn-outline-primary" type="button" data-bs-toggle="collapse" data-bs-target="#multiCollapseExample1" aria-expanded="false" aria-controls="multiCollapseExample2">음원 후원하기</button>
                <button class="btn btn-outline-primary" type="button" data-bs-toggle="collapse" data-bs-target="#multiCollapseExample2" aria-expanded="false" aria-controls="multiCollapseExample2">음원 대여하기</button>
            </div>
           
            <div class="row-lg">
                <div class="collapse multi-collapse" id="multiCollapseExample1">
                  <div class="card card-body">
                    <form class=" mx-auto"> 
                        
                        <div class="row">
                            <div class="col-12">
                                <label for="id" class="col-form-label">음원id</label>
                                <input type="text" class="form-control" id="amount" name="id">
                            </div>
                            <div class="col-12">
                                <label for="amount" class="col-form-label">후원개수</label>
                                <input type="text" class="form-control" id="amount" name="amount">
                            </div>
                        </div> 
                        <div class="d-grid gap-2 d-flex justify-content-center">
                            <button type="submit" id="add-btn" class="btn btn-primary">후원하기</button>
                        </div>
                    </form>  
                    </div>
                </div>
              </div> 
 
              <div class="row-lg">
                <div class="collapse multi-collapse" id="multiCollapseExample2">
                  <div class="card card-body">
                    <form class=" mx-auto"> 
                        <div class="row">
                            <div class="col-12">
                                <label for="condition" class="col col-form-label">대여조건</label>
                                <input type="text" class="form-control" id="condition" name="condition">      
                            </div>
                            <div class="col-12">
                                <label for="period" class="col      -form-label">대여기간</label>
                                <input type="text" class="form-control"  id="period" name="period">
                            </div>  
                        </div> 
                        <div class="d-grid gap-2 d-flex justify-content-center">
                            <button type="submit" id="add-btn" class="btn btn-primary">대여하기</button>
                        </div>
                    </form>  
                    </div>
                </div>
              </div>  
        </div>
    </div>
    </div>
    <div class="p-5 bg-light rounded-3"> 
        <div class="container w-50">    
            <div id="new-alert1"></div>
        <h3 class="mb-4 text-center">음원을 등록합니다</h3>
        <form class=" mx-auto">
        </form>
            <div class="row">
                <div class="col-12">
                    <label for="id" class="col-form-label">곡ID</label>
                    <input type="text" class="form-control" id="new-mid" name="id">
                </div>
                <div class="col-12">
                    <label for="title" class="col-form-label">곡명</label>
                    <input type="text" class="form-control" id="new-title" name="title">
                </div>
                <div class="col-12">
                    <label for="artist" class=" col-form-label">원작자</label>
                    <input type="text" class="form-control" id="new-artist" name="artist">      
                </div>
                <div class="col-12">
                    <label for="length" class=" col-form-label">음원길이</label>
                    <input type="text" class="form-control" id="new-length" name="length">
                </div>
                <div class="col-12">
                    <label for="total" class="col-form-label">전체지분수량</label>
                    <input type="text" class="form-control" id="new-total" name="total">
              
                </div>
            </div>
            <div class="d-grid gap-2 d-flex justify-content-center">
                <button class="btn btn-primary me-md-2" id="new-music-btn">등록하기</button>   
            </div>
    </div>
    </div>
    <div class="p-5 bg-light rounded-3 "> 
        <div class="container w-50">
            <div id="add-alert" class="alert alert-primary" role="alert">
                This is a primary alert with <a href="#" class="alert-link">an example link</a>. Give it a click if you like.
            </div>
        <h3 class="mb-4 text-center">계약조건을 작성합니다</h3>
        <form class=" mx-auto">
            <div class="row">
                <div class="col-12">
                    <label for="title" class="col-form-label">*곡명</label>
                    <input type="text" class="form-control" id="new-title" name="title">
                </div>
                <div class="col-12">
                    <label for="artist" class=" col-form-label">*원작자</label>
                    <input type="text" class="form-control" id="new-artist" name="artist">      
                </div>
                <div class="col-12">
                    <label for="length" class=" col-form-label">수익 분배비율 설정, 사용범위설정</label>
                    <input type="text" class="form-control" id="new-condition" name="condition">
                </div>
                <div class="col-12">
                    <label for="total" class="col-form-label">기간설정</label>
                    <input type="text" class="form-control" id="new-due" name="due">
                </div>
            </div>
            <div class="d-grid gap-2 d-flex justify-content-center">
                <button type="submit" class="btn btn-primary me-md-2" id="new-btn">등록하기</button>       
            </div>
        </form>
    </div>
    </div>

    <div class="p-5  bg-light rounded-3 "> 
        <div class="container w-50">
            <div id="add-alert" class="alert alert-primary" role="alert">
                This is a primary alert with <a href="#" class="alert-link">an example link</a>. Give it a click if you like.
            </div>
        <h3 class="mb-4 text-center">수익분배 이력를 조회합니다</h3>
        <form class=" mx-auto">
            <div class="row">
                <div class="col-12">
                    <label for="title" class="col-form-label">*곡ID</label>
                    <input type="text" class="form-control" id="title" name="title">
                </div>
                
            </div>
            <div class="d-grid gap-2 d-flex justify-content-center">
                <button type="submit" class="btn btn-warning me-md-2" id="new-btn">조회하기</button>       
            </div>
        </form>
    </div>
    </div>
    
    <div class="footer">
        <footer class="py-3 my-4">
          <ul class="nav justify-content-center border-bottom pb-3 mb-3">
            <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">Home</a></li>
            <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">Features</a></li>
            <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">Pricing</a></li>
            <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">FAQs</a></li>
            <li class="nav-item"><a href="#" class="nav-link px-2 text-muted">About</a></li>
          </ul>
          <p class="text-center text-muted">© 2021 MuseShare, Inc</p>
        </footer>
      </div>
</body>

<script>    
    $("#new-music-btn").click(()=>{
        // new-email이라는 id값을 가지고 있는 input의 value를 가지고 옴
        const nmid = $("#new-mid").val();
        const ntitle = $("#new-title").val();
        const nartist = $("#new-artist").val();
        const nlength = $("#new-length").val();
        const ntotal = $("#new-total").val();
        
        const url = "/music"
        
        // email이라는 파라메터에 위의 value를 넣음
        $.post(url, {nmid, ntitle, nartist, nlength, ntotal}, (data,status)=>{
            // http 상태 코드가 200(success)이라면
            console.log(data);
            if(status == "success"){
                // 성공했다는 alert창을 띄움
                
                $('#new-alert1').append("<div id='success' class='alert alert-success'>발행에 성공했습니다!</div>");
                $('#new-alert1').empty()
                $('#new-alert1').fadeIn(2000);
                $('#new-alaert1').fadeOut(4000);
            }
        })
    })
    
    $("#new-btn").click(()=>{
        // new-email이라는 id값을 가지고 있는 input의 value를 가지고 옴
        const issuer = $("#issuer").val();
        const pid = $("#pid").val();
        const idate = $("#idate").val();
        const mdate = $("#mdate").val();
        const fvalue = $("#fvalue").val();
        
        const url = "/paper"

        // email이라는 파라메터에 위의 value를 넣음
        $.post(url, {issuer:issuer, pid:pid, idate:idate, mdate:mdate,fvalue:fvalue,  mode: "issue"}, (data,status)=>{
            // http 상태 코드가 200(success)이라면
            if(status == "success"){
                // 성공했다는 alert창을 띄움
                
                $('#new-alert').empty()
                $('#new-alert').append("<div id='success' class='alert alert-success'>발행에 성공했습니다!</div>");
                $('#new-alert').fadeIn(2000);
                $('#new-alert').fadeOut(4000);
            }
        })
    })
    $("#add-btn").click(()=>{
        // new-email이라는 id값을 가지고 있는 input의 value를 가지고 옴
        const bpid = $("#bpid").val();
        const bfrom = $("#bfrom").val();
        const bto = $("#bto").val();
        const bprice = $("#bprice").val();

        const url = "/paper" 

        // email이라는 파라메터에 위의 value를 넣음
        $.post(url, {pid: bpid , from: bfrom, to: bto, price: bprice, mode: "buy" }, (data,status)=>{
            // http 상태 코드가 200(success)이라면
            if(status == "success"){
                // 성공했다는 alert창을 띄움

                $('#add-alert').empty()
                $('#add-alert').append("<div id='success' class='alert alert-success'>점수추가를 성공했습니다!</div>");
                $('#add-alert').fadeIn(1000);
                $('#add-alert').fadeOut(4000);
            }
        })
    })
    $("#redeem-btn").click(()=>{
        // new-email이라는 id값을 가지고 있는 input의 value를 가지고 옴
        const rpid = $("#rpid").val();
        const rfrom = $("#rfrom").val();
        const rto = $("#rto").val();

        const url = "/paper"

        // email이라는 파라메터에 위의 value를 넣음
        $.post(url, {pid: rpid,from: rfrom, to:rto, mode: "redeem"}, (data,status)=>{
            // http 상태 코드가 200(success)이라면
            if(status == "success"){
                // 성공했다는 alert창을 띄움

                $('#redeem-alert').empty()
                $('#redeem-alert').append("<div id='success' class='alert alert-success'>점수추가를 성공했습니다!</div>");
                $('#redeem-alert').fadeIn(1000);
                $('#redeem-alert').fadeOut(4000);
            }
        })
    })
    
    $("#find-btn").click(()=>{
        const value = $("#qpid").val();
       
        const url = "/paper"
        $.get(url, {pid: value}, (data,status)=>{
            // 조회했을 때 값이 null이 아니면 (일치하는 값이 존재한다면)
            if(status == "success"){
                
                $('#find-alert').empty()
                $('#find-alert').append("<div id='success' class='alert alert-success'>조회를 성공했습니다!</div>");
                $('#find-alert').fadeIn(1000);
                $('#find-alert').fadeOut(4000);

                // stringify는 json객체를 string으로, parse는 string을 json객체로 변환 시켜줌
                 //const parsedData = JSON.parse(data)
                $('#table').empty();
        
                //$('#table').append("<tr><th scope='row'>contents</th><td>" + data.length + "</td></tr>")

                parsedData = data;
                for(var i = 0; i < parsedData.length; i++ ){
                    $('#table').append("<tr><th scope='row'>txid</th><td>" + parsedData[i].TxId + "</td></tr>")
                    $('#table').append("<tr><th scope='row'>value</th><td>" + JSON.stringify(parsedData[i].Value) + "</td></tr>")
                    $('#table').append("<tr><th scope='row'>timestamp</th><td>" + parsedData[i].Timestamp + "</td></tr>")
                    $('#table').append("<tr><th scope='row'>isdelete</th><td>" + parsedData[i].IsDelete + "</td></tr>")
                }
            }        
        })
    })
</script>

<!-- styling -->
<style>
    
    .container-1{
        height: 500px;
        margin: 50px 50px;
        padding: 20px 20px;
        text-align: center;
        position: absolute;
        left: 50%;
        transform:translateX(-50%); 
    }

    button{
        margin: 20px 10px;
    }

    input{
        width: 300px;
        padding: 10px 8px;
    }
    .col-6{
        padding: 20px 10px;
    }
</style>
